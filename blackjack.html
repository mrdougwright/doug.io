<html>
<head>
	<title>Doug's BlackJack Game</title>
	<!--This game was created with the help of Codecademy.com-->
</head>
	
<body>
	<center>
	<br/><br/>
	<button type="button" onclick=playGame()>Play BlackJack</button>
    </center>
	<br/><br/>
	<script type="text/javascript">

function Card(suit, value) {
    var cardSuit = suit;
    var cardValue = value;
    
    this.getNumber = function () {
    	suitArray = ["blank", "Ace", "2", "3", "4", "5", "6", "7", "8", "9", "10", "Jack", "Queen", "King"];
        return suitArray[value];
    };
    this.getSuit = function () {
        if (cardSuit === 1) {
        	suit = "Diamonds";
        }
        else if (cardSuit === 2) {
        	suit = "Hearts";
        }
        else if (cardSuit === 3) {
        	suit = "Spades";
        }
        else {
        	suit = "Clubs";
        }
        return suit;
    };
    this.getValue = function () {
        if(cardValue > 10) {
            return 10;
        } else if (cardValue === 1) {
            return 11;
        } else {
            return cardValue;
        }
    };
}
function deal() {
    var newCardSuit = Math.floor(Math.random()*4 + 1);
    var newCardValue = Math.floor(Math.random()*13 + 1);
    var newCard = new Card(newCardSuit, newCardValue);
    return newCard;
}
function Hand() {
	
    var handArray = [];
    handArray.push(deal());
    handArray.push(deal());
    
    this.getHand = function() {
        return handArray;
    };
    
    this.score = function() {
        var sum = 0;
        var aceCount = 0;
        for (var i = 0; i < handArray.length; i++) {
            sum += handArray[i].getValue();
            if(handArray[i].getNumber() === 1) {
                aceCount++;
            }
        } // while statement for removing aces
        while (sum > 21 && aceCount !== 0) {
            aceCount--;
            sum -= 10;
        }
        /*if (sum > 21) {
        	return sum + " Bust!"
        }
        else { */
        return sum;
        
    };
    
    this.printHand = function() {
        var string = "";
        for(j=0; j < handArray.length; j++) {
            string = string + handArray[j].getNumber() + " of " + handArray[j].getSuit()+ ", ";
        }
        return string;
    };
    
    this.hitMe = function() {
        var addCard = new deal();
        handArray.push(addCard);
    };
}
function playAsDealer() {
    var dealerHand = new Hand();
    
    while (dealerHand.score() < 17) {
        dealerHand.hitMe();
    }
    return dealerHand;
}
function playAsUser() {
    var playerHand = new Hand();
    var decision = false;
    do {
    	if (playerHand.score() <= 21) {
    	decision = confirm("Your hand contains a "+ playerHand.printHand() + "Your total is: " + playerHand.score() + ". Press CANCEL to stay.  OK to take another card.");
    	//decision = confirm("CANCEL to stay.  OK to take another card.");
    	}
    	else {
    	decision = false;
    	}
        if (decision) {
            playerHand.hitMe();
        }
    } while (decision);
    return playerHand;
}
function declareWinner(userHand, dealerHand) {
    var handUser = userHand.score();
    var handDealer = dealerHand.score();
    
    if (handUser > 21) {
        if (handDealer > 21) {
            return "You both bust!";
        } else {
            return "Bust! You lose!";
        }
    } else if (handDealer > 21) {
        return "Dealer busts. You win!";
    } else if (handUser > handDealer) {
        return "You win!";
    } else if (handUser === handDealer) {
        return "You tied!";
    } else {
        return "You lose!";
    }
}
function playGame() {
    var userHand = playAsUser();
    var dealerHand = playAsDealer();
    var winner = declareWinner(userHand, dealerHand);
    
    document.write("Dealer's Hand: <br />" + dealerHand.printHand() + " <br />");
    document.write("Dealer's score: " + dealerHand.score() + " <br /><br />");
    
    document.write("User's Hand: <br />" + userHand.printHand() + " <br />");
	document.write("User's score: " + userHand.score() + " <br /><br />");

    document.write("Result: " + winner);
} 
//make the playgame into a button

//playGame();
</script>
</body>
</html>